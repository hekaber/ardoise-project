{% extends "shared/base.html" %}
{% load static %}
{% load materializecss %}
{% block title %}
    Contacts - Invite
{% endblock %}
{% block content %}
    <div class="container">
        <h1 class="header center">Invite</h1>
        <div class="row">
            <form action="{% url 'ContactListView' %}" method="GET" value="{{ request.GET.search }}">
                <div class="input-field col s9">
                    <i class="material-icons prefix">search</i>
                    <label for="search">Search</label>
                    <input type="text" name="search" value="{{ request.GET.search }}" placeholder="Search contacts"/>
                </div>
                <div class="col s3">
                    <button class="btn-large waves-effect waves-light  green lighten-1" type="submit">Go</button>
                </div>
            </form>
        </div>
        <div class="row center">
            <ul class="collection with-header">
                <li class="collection-header">
                    <div class="row">
                        <div class="col s4"><h5>Last Name</h5></div>
                        <div class="col s4"><h5>First Name</h5></div>
                        <div class="col s1"><h5>Email</h5></div>
                        <div class="col s1"></div>
                    </div>
                </li>
                {% for contact in contact_list %}
                    <li class="collection-item">
                        <div class="row">
                            <form id="inviteForm" action="{% url 'InviteConfirmationView' %}" method="POST">
                                {% csrf_token %}
                                <div class="col s4">{{ contact.first_name }}</div>
                                <div class="col s4">{{ contact.last_name }}</div>
                                <div class="col s2">{{ contact.email }}</div>
                                {% if contact.id not in invites_map|keys %}
                                    <input type="hidden" name="contact" value="{{ contact.id }}"/>
                                    <div class="col s1">
                                        <button data-target="modal_confirm" class="btn-large modal-trigger waves-effect waves-light green lighten-1"
                                                type="submit">Invite
                                        </button>
                                    </div>
                                {% else %}
                                    <div class="col s1">{{ invites_map|get_item:contact.id }}</div>
                                {% endif %}
                            </form>
                        </div>
                    </li>
                {% endfor %}
            </ul>
        </div>
    </div>
    <!-- Modal Structure -->
    <div id="modal_confirm" class="modal">
        <div class="modal-content">
            <h4>Inviting</h4>
            <p>Confirm invitation?</p>
        </div>
        <div class="modal-footer">
            <button id="inviteYes" class="modal-close waves-effect waves-green btn-flat">Yes</button>
            <button id="inviteNo" class="modal-close waves-effect waves-red btn-flat">No</button>
        </div>
    </div>
{% endblock %}
{% block scripts %}
    {{ block.super }}
    <script src="{% static "/assets/js/contact.js" %}"></script>
{% endblock %}